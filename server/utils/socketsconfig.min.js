const socketIo=require("socket.io"),{CheckOne_One:CheckOne_One,insertImageData:insertImageData}=require("../database/queries"),db=require("../database/model"),{thumbnailImage:thumbnailImage}=require("./thumbconvertor"),{privateChat:privateChat}=require("./privatechatsocket"),{roomChat:roomChat}=require("./roomchatsocket"),clientArry={};function appendClient(data){clientArry[data.id]||(clientArry[data.id]={username:data.username})}function removeClient(data){clientArry[data.id]&&delete clientArry[data.id]}function setupSocket(server,allowedOrigin){const io=socketIo(server,{cors:{origin:allowedOrigin},maxHttpBufferSize:1e7}),mainIO=io.of("/main"),privateChatIO=io.of("/main/chat"),roomChatIO=io.of("/main/room");return mainIO.on("connection",(socket=>{console.log(`User '${socket.handshake.auth.username}' connect main`),socket.on("disconnect",(()=>{const auth=socket.handshake.auth;console.log(`User '${auth.username}' disconnect main`)}))})),privateChat(privateChatIO),roomChat(roomChatIO),io}module.exports=setupSocket;