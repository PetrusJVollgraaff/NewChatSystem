const express=require("express"),bcrypt=require("bcryptjs"),db=require("../database/model"),{createToken:createToken}=require("./auth"),profilerouter=express.Router();profilerouter.post("/update",(async(req,res)=>{const{username:username,password:password,userId:userId}=req.body,hashedPassword=await bcrypt.hash(password,10);try{const user=db.prepare("UPDATE users SET username=?, password=? WHERE id=? RETURNING id, username").get(username,hashedPassword,userId),useId=user.id,newUsename=user.username,accessToken=createToken({res:res,id:useId,username:newUsename});res.json({id:useId,username:newUsename,token:accessToken})}catch(err){return console.error("Update user profile error",err),res.status(400).json({message:"Your could not be updated"})}})),module.exports={profilerouter:profilerouter};